# 2025-12-19 RN更新0.83 Taro更新4.1.9

## 基础库
- 更新Taro到最新的4.1.9版本
- 新增 `useLockFn` 可以用于锁定函数执行，直到函数执行结束才能再次被执行

## React Native

更新版本到最新 0.83.1，从0.82开始RN仅支持新架构，将完全移除对旧架构的支持，因此如果RN端要更新，请谨慎选择

此次更新后下面的模块插件需要替换为新模块，并从新的插件导入，旧的插件已经无法在新架构下运行，旧模块已经停止维护，后期不会再更新

| 旧模块 | 新模块 |
| ---- | -------- |
| react-native-amap3d | expo-gaode-map |
| react-native-alipay@uiw | expo-alipay |
| react-native-wechat-lib | expo-wechat |

- 修复触摸事件会漂移的问题
- 修复 Android 16 上返回按钮无法关闭页面的问题
- 配合上表的新模块，App 端支付/分享/小程序跳转均改用 `expo-wechat`，`loadApp` 签名、Manifest 等细节已调整以适配新架构

## duxappCanvas 画布

RN端现在已经补全大部分的api，并且已经验证过，基本可行

- Canvas 重构为 Skia/GCanvas 双实现，默认导出 Skia 版本，H5/小程序使用 2D Canvas
- 新增跨端 `OffscreenCanvas` 支持，RN 端基于 Skia，其他端基于 `createOffscreenCanvas`，方便离屏绘制

## UI库

- Checkbox 新增 type 属性
- Radio 新增 type 属性
- Textarea 新增 white 属性
- List 去除非手动下拉刷新的刷新效果
- 新增 Slider 组件，这个组件仅是为了兼容RN端Taro组件兼容性差的bug
- Button `soft` 模式在暗色主题下调整底色算法，避免文字对比度过低

## duxappStyle

- 新增边框颜色工具类 `.border-page`、`.border-c1 ~ .border-c4`、`.border-custom1 ~ 3`，以及 `.shadow`、`.shadow-white` 阴影样式

## 鸿蒙

- 修复高版本nodejs编译失败的问题
- 跟随Taro更新到最新版本

## duxappWechatShare

- RN 端改用 `expo-wechat`，新增 App 内分享面板，支持小程序与 H5 分享

## CLI

- 新增 duxapp.config.js 用于控制 cli行为
```js
export default {
  install: {
    allModuleDependencies: true
  }
}
```
支持的第一个配置 `install.allModuleDependencies` 任意命令在生成运行时文件并执行依赖安装时，都会聚合 `src` 目录下所有模块的依赖项

- 修复生成图标组件 types 错误的问题
- 修复 nodejs F_OK 警告
